## 1. **什么是雅可比矩阵和雅可比行列式？**

### 雅可比矩阵（Jacobian matrix）

- 假如你有一个多变量函数，$x = g(z)$，其中$z$和$x$都是$n$维向量。
- 雅可比矩阵就是所有偏导数按行/列排成的$n \times n$矩阵：

  $$
  J = \frac{\partial x}{\partial z} = 
  \begin{bmatrix}
    \frac{\partial x_1}{\partial z_1} & \cdots & \frac{\partial x_1}{\partial z_n} \\
    \vdots & \ddots & \vdots \\
    \frac{\partial x_n}{\partial z_1} & \cdots & \frac{\partial x_n}{\partial z_n}
  \end{bmatrix}

  $$

  它描述了：每个$x$的分量，对每个$z$分量的“敏感度”或“变化率”。

---

### 雅可比行列式（Jacobian determinant）

- 就是把上述矩阵$J$求行列式：$\det J$。
- **它衡量：在$z$空间中一个小区域经$g$变换后，在$x$空间体积放大或缩小了多少倍。**

---

## 2. **几何直观**

假设你在二维空间：

- $z$空间中画一个小矩形，边长$\Delta z_1, \Delta z_2$，面积$\Delta z_1 \Delta z_2$。
- 经过$x = g(z)$变换，这个矩形可能变成了一个“歪斜”的平行四边形，面积通常≠原来那么大。
- **新面积≈原面积 × $|\det J|$**。

**结论：$|\det J|$ 就是“小片面积/体积在变换后变大的倍数”。
（如果$|\det J|=2$，一个单位面积变成2，$|\det J|=0.5$缩小一半）**

---

## 3. **概率上的理解**

- 概率“密度×区域体积”=概率质量。不论怎么变换，**总概率守恒**！
- 但经过空间变化后，小区域体积会变了，密度就要“反向变换”来守恒概率。
- 那么密度怎么调节？靠这个$|\det J|$：

  $$
  p_x(x) = p_z(z)\,/\,|\det J|

  $$

  （或用逆变换公式见归一化流相关内容）

  体积变大，密度变小，体积变小，密度变大。

---

## 4. **简单例子加深理解**

**例子（二维线性变换）**假如$x_1 = 2z_1,\ x_2 = 3z_2$，则

- 雅可比矩阵 $J = \begin{bmatrix} 2 & 0 \\ 0 & 3 \end{bmatrix}$
- $|\det J| = 2 \times 3 = 6$
- 说白了，面积被拉大6倍。
  如果原来一个区域的概率质量是0.001，变换后在新区域的密度就要缩小为1/6，以保证概率不变。

---

## 5. **物理&生活类比**

- 想象你地图上放大或拉伸某一块地皮，面积变大，你单位面积上居民密度就自然变小，整体总人数没变。

---

## 6. **一句话总括**

> **雅可比行列式的绝对值$|\det J|$，衡量的是变量变换下，微小体积（面积、长度）发生了多大伸缩。它是密度从一个空间变换到另一个空间时，必须调整的缩放因子。**
