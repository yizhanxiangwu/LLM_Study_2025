# 1. 什么是高斯分布？

**高斯分布**也称为**正态分布（Normal Distribution）**，是最常用的一种连续概率分布。
它呈现出经典的“钟形曲线”——大多数数据集中在均值附近，较远的值概率快速下降。

在**Normalizing Flows**和各种生成模型中经常用作“基础分布”（base distribution）

---

### 2. 一维高斯分布公式

对于随机变量 $x$，均值为 $\mu$，方差为 $\sigma^2$：

$$
p(x) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)

$$

- $\mu$：均值（中心点）
- $\sigma$：标准差（控制曲线宽窄）

---

### 3. 多维高斯分布公式（前面公式用的是二维情况）

对于维度为 $d$ 的向量 $\mathbf{z}$：

$$
p(\mathbf{z}) = \frac{1}{(2\pi)^{d/2}|\Sigma|^{1/2}} \exp\left( -\frac{1}{2} (\mathbf{z}-\boldsymbol{\mu})^T \Sigma^{-1}(\mathbf{z}-\boldsymbol{\mu}) \right)

$$

- $\mathbf{z}$：长度为$d$的向量（比如2D，$\mathbf{z}=(z_1, z_2)$）
- $\boldsymbol{\mu}$：均值向量
- $\Sigma$：协方差矩阵（描述各个维度之间的相关性）；最常见的情况是单位协方差$\Sigma=I$（独立同分布）

---

### 4. 在Normalizing Flows中的作用

- 作为基础分布（$p_{\text{base}}(\mathbf{z})$）在Normalizing Flows等生成模型中，我们常常用“标准高斯分布”（$\mu=0, \Sigma=I$）作为简单、易采样的起点（base distribution）：

  - 从标准高斯采样点$\mathbf{z}$；
  - 经过一系列可逆变换，映射到复杂分布的空间，得到$\mathbf{x}$；
  - 这个变换通过上面提到的变换密度公式调整概率密度。
- **优点：采样简单、密度易算、数学性质好**
  所以你会经常在公式中看到$p_{\text{base}}$就是高斯。

  1. **采样简单**

  * 从高斯分布采样极其简单、高效，不需要复杂算法。成熟的采样器和库随手可用。
  * 比如，一条Python代码就能得到标准高斯样本：
    ```python
    np.random.randn()
    ```

  2. **概率密度函数有闭式表达式** (闭式就代表有明确的公式）

  * 高斯分布的概率密度函数（pdf）是已知且易算的，无需数值积分或复杂查表，这让训练和计算概率密度都很高效。

  3. 数学性质优良

  * 高斯分布是中心极限定理的核心：大量独立随机变量的和趋于高斯分布。
  * 这种性质让它非常适合作为“模型学习的起点”（理论上不会引入偏置）。
  * 多维高斯分布依然保持对称、光滑，无特殊“角落”或怪异行为，适合通过可逆变换变为各种复杂分布。

  4. **变换后仍然“覆盖全面”**

  * 标准高斯分布的支持集是整个实数域（理论上任何点都有概率被采到），变换潜空间时不易丢掉“角落分布”。
  * 如果用均匀分布等有限区间的分布，一旦经过复杂变换，可能很多真实数据区域采不到。

  5. 推理和优化友好

  * 在VAE等生成模型中，计算KL散度（衡量两个高斯分布距离）有解析公式，优化友好。
  * 对于很多概率相关推导（比如ELBO、变化推断）都能简化推理和代码实现。

  ---

  ## 总结一句话


  > **高斯分布“起点”=采样高效 + 概率计算简单 + 数学友好 + 变换后能生成全空间复杂分布，是生成模型的理想选择。**
  >

---

### 5. 图形直观

- 一维高斯：钟形曲线
- 二维高斯：椭圆形等概率线，中心点为均值

---

## 总结

- **高斯分布**是一种最常用的概率分布，经常作为生成模型中的“基础分布”使用。
- 在Normalizing Flows中，我们用它作为“起点”，生成复杂数据的第一步。

![高斯分布曲线](https://upload.wikimedia.org/wikipedia/commons/8/8c/Standard_deviation_diagram.svg)

---

### 图中要点

- 横轴 \(x\)：自变量（取值）
- 纵轴 \(p(x)\)：概率密度
- 曲线中心为均值 \(\mu\)，最宽处高度即概率密度最大
- 越远离均值，曲线下降很快，说明极端值出现概率很低
